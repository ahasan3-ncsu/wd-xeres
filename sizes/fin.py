import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

res = [[0.011758240586737792, 0.007788538616826259, 0.0038753815962338707, 0.0022710314085413264, 0.0015360768343854736, 0.0011414239083059653, 0.0009033983605519983, 0.0007473379588239732, 0.0006384973924899611, 0.0005589234029991938, 0.000498553110574474, 0.00045137055267001293, 0.0004135866380108592, 0.00038271013066079775, 0.0003570431909315314, 0.0003353929030489606, 0.0003168989135992933, 0.00030092649430800905, 0.0002869979940778014, 0.00027474762595159464, 0.0002638908840554095, 0.0002542033894576496, 0.0002455059605825973, 0.00023765388682199967, 0.00023052909444538518],
[0.01188115155198929, 0.008444461925331248, 0.004439700133459772, 0.0026449406979750212, 0.0018004179653702927, 0.001341910910604731, 0.001063834466016477, 0.0008809325961852943, 0.0007531162366952823, 0.000659543279921582, 0.0005884851765334817, 0.0005329110239887375, 0.0004883837895610116, 0.00045198196312290376, 0.0004217122270104303, 0.00039617282482326413, 0.00037435206857204946, 0.000355503152324637, 0.00033906381551346477, 0.00032460330497207084, 0.00031178647183379186, 0.00030034891995166956, 0.00029007945928266604, 0.00028080749114550637, 0.00027239379275676665],
[0.011985843101004924, 0.008986009414047681, 0.004968525312360553, 0.0030078443739917967, 0.00206037538866889, 0.0015402944214110612, 0.0012231195077876096, 0.001013834432003328, 0.0008672872680218782, 0.0007598573185614013, 0.0006781990658003196, 0.0006142902747504211, 0.0005630583043914854, 0.0005211582215663828, 0.0004863052364360804, 0.0004568911977576679, 0.00043175463265058655, 0.0004100376714231335, 0.00039109412622756094, 0.00037442874823535714, 0.0003596560768190822, 0.0003464719376312089, 0.00033463330583631014, 0.00032394382465569533, 0.00031424321985614535],
[0.012077059688757268, 0.009437813903924194, 0.005464428224408825, 0.0033601108966904796, 0.0023160314442339947, 0.0017365993900109362, 0.0013812628123555902, 0.0011460475212630218, 0.0009810124604089537, 0.0008598665674008125, 0.0007676953752791623, 0.0006955086643834011, 0.0006376104092053015, 0.0005902390546501566, 0.0005508223199659319, 0.0005175480921109439, 0.0004891066560500683, 0.00046453008827679944, 0.0004430889535189773, 0.00042422397632107953, 0.0004074997151138797, 0.00039257245469537927, 0.0003791675100189091, 0.00036706289527051547, 0.00035607738194654796],
[0.012157876425105373, 0.009818648279281719, 0.005929780809969965, 0.0037020956065304733, 0.0025674668300707643, 0.0019308504517865826, 0.0015382736260850511, 0.0012775758937903438, 0.0010942937785394897, 0.0009595720712267868, 0.0008569747000941348, 0.0007765665514669275, 0.0007120403302614399, 0.0006592246107881567, 0.0006152635782159548, 0.0005781435780568905, 0.0005464081889328487, 0.000518980439525121, 0.0004950483246643659, 0.00047398900988227617, 0.0004553174024942933, 0.00043865048375360234, 0.0004236820817589878, 0.0004101647105852119, 0.0003978962854450758]]

radii = np.linspace(1, 101, 25)

print(len(res))
for resi in res:
    plt.plot(radii, resi)

    def mod(x, k, c, d):
        return k / (1 + (x/c)**d)

    #p, c = curve_fit(mod, radii, res[i], p0=[1.5, 0.04, 10, 0.2, 3.5])
    p, c = curve_fit(mod, radii, resi, sigma=resi)
    print(p)
    plt.plot(radii, mod(radii, *p), label='help')

plt.yscale('log')
plt.ylim([1e-4, 1e-1])
plt.legend()
plt.show()
