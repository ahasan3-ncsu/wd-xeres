import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

radii = np.linspace(1, 41, 25)

res = [[0.011758240586737792, 0.007788538616826259, 0.0038753815962338707, 0.0022710314085413264, 0.0015360768343854736, 0.0011414239083059653, 0.0009033983605519983, 0.0007473379588239732, 0.0006384973924899611, 0.0005589234029991938, 0.000498553110574474, 0.00045137055267001293, 0.0004135866380108592, 0.00038271013066079775, 0.0003570431909315314, 0.0003353929030489606, 0.0003168989135992933, 0.00030092649430800905, 0.0002869979940778014, 0.00027474762595159464, 0.0002638908840554095, 0.0002542033894576496, 0.0002455059605825973, 0.00023765388682199967, 0.00023052909444538518],
[0.01193542720919273, 0.00872783527950171, 0.004708383834356425, 0.002827744895606978, 0.001930939455348325, 0.0014413640357086594, 0.0011436202850717365, 0.0009474698602590987, 0.0008102576053956567, 0.0007097384634041236, 0.0006333693559062915, 0.0005736207794550137, 0.0005257363623868517, 0.00048658202980004226, 0.00045401822875425256, 0.0004265397005022878, 0.00040305967133340916, 0.0003827756769457776, 0.0003650834080040064, 0.0003495198047923094, 0.00033572452111782134, 0.00032341324212610626, 0.00031235883842786196, 0.0003023778162909494, 0.0002933204148155034],
[0.012077059688757268, 0.009437813903924194, 0.005464428224408825, 0.0033601108966904796, 0.0023160314442339947, 0.0017365993900109362, 0.0013812628123555902, 0.0011460475212630218, 0.0009810124604089537, 0.0008598665674008125, 0.0007676953752791623, 0.0006955086643834011, 0.0006376104092053015, 0.0005902390546501566, 0.0005508223199659319, 0.0005175480921109439, 0.0004891066560500683, 0.00046453008827679944, 0.0004430889535189773, 0.00042422397632107953, 0.0004074997151138797, 0.00039257245469537927, 0.0003791675100189091, 0.00036706289527051547, 0.00035607738194654796],
[0.012195070651252816, 0.009987087267638027, 0.006151691480897554, 0.0038693398576728428, 0.0026916265493925878, 0.0020272133813466855, 0.0016163572166404505, 0.001343084563760356, 0.0011507685962184398, 0.0010093112442045014, 0.0009015331788133683, 0.0008170354183770002, 0.0007492095424651138, 0.0006936817063149556, 0.0006474558042648874, 0.0006084183147832183, 0.0005750400370917878, 0.0005461898519878789, 0.0005210147227001797, 0.0004988602101661638, 0.0004792165195501668, 0.0004616810691029192, 0.00044593200847137607, 0.00043170915004576104, 0.00041880001715783206]]

for i in range(4):
    plt.plot(radii, res[i])

    def mod(x, a, b, c, d, e):
        return a * np.exp(-b*x) + c * np.exp(-d*x**2) / (1 + e*x**2)

    p, c = curve_fit(mod, radii, res[i], p0=[1.5, 0.04, 10, 0.2, 3.5])
    print(p)
    plt.plot(radii, mod(radii, *p), label='help')

    plt.legend()
    plt.show()
